"use strict";(self.webpackChunkfootball_fixer_frontend=self.webpackChunkfootball_fixer_frontend||[]).push([[411],{411:(e,t,i)=>{i.r(t),i.d(t,{default:()=>h});var o=i(43),a=i(216),n=i(104);const d={NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_SOCKET_URL||"http://localhost:3000",l=(0,n.io)(d,{autoConnect:!1});var s=i(198),c=i(729),r=i(579);const h=function(){const{id:e}=(0,a.g)(),{user:t}=(0,c.A)(),[i,n]=(0,o.useState)([]),[d,h]=(0,o.useState)(""),[u,v]=(0,o.useState)(!0),[m,f]=(0,o.useState)(""),g=(0,o.useRef)(null);return(0,o.useEffect)(()=>{(async()=>{v(!0),f("");try{const t=await s.A.get(`/chat/matches/${e}`);n(t.data)}catch(t){f("Failed to load chat history")}finally{v(!1)}})()},[e]),(0,o.useEffect)(()=>(l.connect(),l.emit("joinMatch",{matchId:e,teamId:null===t||void 0===t?void 0:t._id}),l.on("chatMessage",e=>{n(t=>[...t,e])}),()=>{l.emit("leaveMatch",{matchId:e,teamId:null===t||void 0===t?void 0:t._id}),l.off("chatMessage"),l.disconnect()}),[e,null===t||void 0===t?void 0:t._id]),(0,o.useEffect)(()=>{var e;null===(e=g.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})},[i]),u?(0,r.jsx)("div",{children:"Loading chat..."}):m?(0,r.jsx)("div",{style:{color:"red"},children:m}):(0,r.jsxs)("div",{style:{maxWidth:600,margin:"0 auto"},children:[(0,r.jsx)("h2",{children:"Match Chat"}),(0,r.jsxs)("div",{style:{border:"1px solid #ccc",padding:16,height:400,overflowY:"auto",background:"#f9f9f9"},children:[i.map((e,t)=>{var i,o;return(0,r.jsxs)("div",{style:{marginBottom:12},children:[(0,r.jsx)("div",{children:(0,r.jsxs)("strong",{children:[(null===(i=e.sender)||void 0===i?void 0:i.teamName)||"Unknown"," (",(null===(o=e.sender)||void 0===o?void 0:o.collegeName)||"Unknown",")"]})}),(0,r.jsx)("div",{children:e.message}),(0,r.jsx)("div",{style:{fontSize:12,color:"#888"},children:new Date(e.timestamp).toLocaleString()})]},t)}),(0,r.jsx)("div",{ref:g})]}),(0,r.jsxs)("form",{onSubmit:i=>{if(i.preventDefault(),!d.trim())return;const o={matchId:e,sender:{teamName:null===t||void 0===t?void 0:t.teamName,collegeName:null===t||void 0===t?void 0:t.collegeName,_id:null===t||void 0===t?void 0:t._id},message:d,timestamp:(new Date).toISOString()};l.emit("chatMessage",o),h("")},style:{marginTop:12,display:"flex",gap:8},children:[(0,r.jsx)("input",{value:d,onChange:e=>h(e.target.value),placeholder:"Type a message...",style:{flex:1}}),(0,r.jsx)("button",{type:"submit",children:"Send"})]})]})}}}]);
//# sourceMappingURL=411.7c3e4f1f.chunk.js.map